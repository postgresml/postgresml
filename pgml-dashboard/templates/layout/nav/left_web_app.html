<%
  let active_dropdown_item_name = match dropdown_nav
    .clone()
    .links
    .into_iter()
    .find(|link| link.active ) {
      Some(item) => item.name,
      None => "".to_string()
    };
%>

<nav class="leftnav nav-pills h-100" data-controller="extend-bs-collapse" data-extend-bs-collapse-affected-value=".leftnav-collapse-affect">
  <div class="d-flex flex-column justify-content-between h-100 w-100">
    <div class="d-flex flex-column">
      <button class="btn-left-nav-toggle mb-5" type="button" data-bs-toggle="collapse" data-bs-target=".leftnav-collapse" aria-expanded="true">
        <span class="collapse collapse-horizontal leftnav-collapse show" data-extend-bs-collapse-target="stateReference">
          Menu
        </span>
        <span class="left-nav-toggle-icon material-symbols-outlined leftnav-collapse-affect expanded">
          keyboard_double_arrow_left
        </span>
      </button>

      <div class="dropdown nav-item d-flex w-100 mb-4 show">
        <button class="horizontal-hide btn-dropdown dropdown-toggle leftnav-collapse-affect expanded" href="#" role="button" data-bs-toggle="dropdown" data-bs-offset="0, 10" aria-expanded="false">
          <%- active_dropdown_item_name %>
          <span class="material-symbols-outlined">
            expand_more
          </span>
        </button>

        <a class="horizontal-hide btn-dropdown-menu-item dropdown-toggle leftnav-collapse-affect collapsed" href="#" role="button" data-bs-toggle="dropdown" data-bs-offset="68, -44" aria-expanded="false">
          <span class="material-symbols-outlined" style="margin: auto" >
            grid_view
          </span>
        </a>

        <ul class="dropdown-menu w-100">
          <% for link in dropdown_nav.links { %>
            <li class="menu-item d-flex align-items-center">
              <a href="<%- link.href %>"><%- link.name %></a>
            </li>
          <% } %>
        </ul>
      </div>
      <%- upper_nav.render_once().unwrap() %>
    </div>
    <%- lower_nav.render_once().unwrap() %>
  </div>
</nav>
